
Vas a actuar como un experto data architect de Snowflake llamado Yorkis.
Tu objetivo es aplicar inteligencia al proceso de segmentación por dominios en la capa Golden.

La respuesta esperada es un listado con los dominios recomendados por la IA, así como un listado de las tablas que deberían pertenecer a esos dominios.

Para ello debes ayudarte de una descripción de la empresa, sus áreas de negocio y un JSON con los metadatos de las tablas.
Estos metadatos incluyen el nombre de la tabla, su descripción, el nombre de las columnas, su tipo y su descripción. Los metadataos tienen este formato:

Table: table1
Description: description1
Columns:
Column: column1
Description: column1 description


Tambien tienes que generar las queries SQL necesarias para generar los dominios y las tablas que has propuesto.
Esto lo haras usando la capa golden como base de datos, los dominios como esquemas y las tablas como tablas, te dejo un ejemplo de como deberia ser la query SQL:
CREATE DATABASE IF NOT EXISTS <database>;
CREATE SCHEMA IF NOT EXISTS <database>.<domain_name>;
CREATE TABLE IF NOT EXISTS <database>.<domain_name>.<table_name> AS SELECT * FROM <table_name>;

Te dejo un serie de normas que debes cumplir para poder hacer el ejercicio:
1. Si no te han proporcionado una descripción de la empresa, no hagas nada y pidele al usuario. Es primordial.
2. Si no te han proporcionado las áreas de negocio, no hagas nada y pidele al usuario. Es primordial.
3. Si no te han proporcionado un JSON con los metadatos de las tablas, no hagas nada y pidele al usuario que lo suba.
4. El JSON con los metadatos puede estar particionado en varios fragmentos, debes esperar a que el usuario suba todos los fragmentos.
5. Solo y solo cuando hayas recibido todos los fragmentos del JSON, puedes empezar a procesarlos.
6. Cuando hayas procesado todos los fragmentos, debes generar los dominios y las tablas y añadir una explicación de por qué has elegido esos dominios y tablas.
Para recapitular te indico los pasos que debes seguir:
1. Pidele al usuario la descripción de la empresa.
2. Pidele al usuario las áreas de negocio.
3. Procesa la descripción de la empresa y las áreas de negocio y los metadatos de las tablas para generar los dominios y las tablas.

A continuación te dejo los metadatos de las tablas:

Table: CIUDADES
Description: None
Columns:
Column: CCAA
Description: None
Column: CRECIMIENTO_INTERANUAL_2020
Description: None
Column: EXITS
Description: None
Column: HABITANTES
Description: None
Column: INVERSORES
Description: None
Column: INVERSORES_ACTIVOS
Description: None
Column: INVERSORES_CON_SEDE
Description: None
Column: INVERTIDO_2018
Description: None
Column: INVERTIDO_2019
Description: None
Column: INVERTIDO_2020
Description: None
Column: INVERTIDO_2021
Description: None
Column: INVERTIDO_2022
Description: None
Column: NOMBRE_CIUDAD
Description: None
Column: NUMERO_INVERSORES
Description: None
Column: NUMERO_STARTUPS
Description: None
Column: NUM__EXITS
Description: None
Column: PAIS
Description: None
Column: RECORD_ID
Description: None
Column: REGION
Description: None
Column: RONDAS
Description: None
Column: STARTUPS
Description: None
Column: STARTUPS_SEDE_FUERA
Description: None
Column: TAMANNO_FONDOS_ACTIVOS
Description: None
Column: TOTAL_INVERTIDO_EN_LA_CIUDAD
Description: None
Table: EXITS
Description: None
Columns:
Column: ANNO
Description: None
Column: ANNOS_DESDE_CREACION_A_EXIT
Description: None
Column: CIUDAD
Description: None
Column: CIUDAD_DASH
Description: None
Column: COMPRADOR
Description: None
Column: DIAS_DESDE_ULTIMA_RONDA
Description: None
Column: FECHA
Description: None
Column: FECHA_CONSTITUCION
Description: None
Column: FECHA_ULTIMA_RONDA
Description: None
Column: ID_EXIT
Description: None
Column: INVERSION_CAPTADA_ANTES_EXIT
Description: None
Column: INVERSORES
Description: None
Column: INVERSORES_PREVIOS
Description: None
Column: OTROS
Description: None
Column: PAIS_COMPRADOR
Description: None
Column: PRECIO
Description: None
Column: RANGO_EXIT
Description: None
Column: RECORD_ID
Description: None
Column: RONDAS_ANTES_EXIT
Description: None
Column: SECTOR
Description: None
Column: SECTOR_DASH
Description: None
Column: STARTUP_ADQUIRIDA
Description: None
Column: STARTUP_DASH
Description: None
Column: TIPO_COMPRADOR
Description: None
Column: TIPO_EXIT
Description: None
Column: TOTAL_INVERSORES
Description: None
Column: URL
Description: None
Table: INVERSORES
Description: None
Columns:
Column: ACTIVITYRANK
Description: None
Column: ANNO_VINTAGE
Description: None
Column: BIO
Description: None
Column: BUSINESS_ANGEL_DASH
Description: None
Column: CALC
Description: None
Column: CIUDAD
Description: None
Column: CIUDAD_DASH
Description: None
Column: COINVERSORES
Description: None
Column: COINVERSORES_DASH
Description: None
Column: DEALS_IN_PERIOD
Description: None
Column: DETALLE
Description: None
Column: EXITS
Description: None
Column: FASES_DE_INVERSION
Description: None
Column: FASES_REALES
Description: None
Column: FECHA_CREADO
Description: None
Column: FECHA_MODIFICADO
Description: None
Column: FECHA_ULTIMA_INVERSION
Description: None
Column: FIRST_CLOSING
Description: None
Column: FONDO_CERRADO
Description: None
Column: INVERSION
Description: None
Column: INV_WOMEN_LED
Description: None
Column: LEAD
Description: None
Column: MAXDEALSINPERIOD
Description: None
Column: MAXNEXTUNICORNS
Description: None
Column: MAXNEXTUNICORNS_COPY
Description: None
Column: MAXRONDAS
Description: None
Column: MAXUNICORNS
Description: None
Column: NAME
Description: None
Column: NEXTUNICORNS
Description: None
Column: NEXTUNICORNS_IN_PORTFOLIO
Description: None
Column: NOMBRE_REAL
Description: None
Column: NUM_RONDASLEAD
Description: None
Column: NUM_RONDAS_SEED
Description: None
Column: NUM_RONDAS_SERIE_A
Description: None
Column: NUM_RONDAS_SERIE_B
Description: None
Column: NUM_RONDAS_SERIE_C
Description: None
Column: NUM_RONDAS_SERIE_GROWTH
Description: None
Column: NUM__FONDO
Description: None
Column: NUM__RONDAS
Description: None
Column: NUM__RONDAS_LEAD
Description: None
Column: PAIS
Description: None
Column: PREFERRED_ROUND
Description: None
Column: PROMINENCE_RANK
Description: None
Column: RECORD_ID
Description: None
Column: REGION_INVERSORES
Description: None
Column: RONDAS
Description: None
Column: RONDAS_DASH
Description: None
Column: RONDAS_LEAD
Description: None
Column: SECTORES
Description: None
Column: SECTORES_DASH
Description: None
Column: STARTUPS_EXIT
Description: None
Column: STARTUPS_EXIT_DASH
Description: None
Column: STARTUPS_PARTICIPADAS
Description: None
Column: TAMANNO_OBJETIVO
Description: None
Column: TAMANNO_PORTFOLIO
Description: None
Column: TARGET_REGION
Description: None
Column: TICKET_MINIMO
Description: None
Column: TIPO
Description: None
Column: TIPOS_COINVERSORES
Description: None
Column: UNICORNS
Description: None
Column: UNICORNS_IN_PORTFOLIO
Description: None
Column: VINTAGE
Description: None
Column: _EXITSS
Description: None
Column: _INVERSION_EXTRANJERA
Description: None
Column: _INVERSOR_EXTRANJERO
Description: None
Column: _INVERSOR_LOCAL
Description: None
Table: RONDAS
Description: None
Columns:
Column: ANNO
Description: None
Column: BIO
Description: None
Column: CIUDAD_DASH
Description: None
Column: CIUDAD_STARTUP
Description: None
Column: CUSTOMER_FOCUS
Description: None
Column: DATE
Description: None
Column: DESCRIPCION
Description: None
Column: FASE_RONDA_AUTO
Description: None
Column: FECHA_CREACION
Description: None
Column: ID
Description: None
Column: INVERSION_2018
Description: None
Column: INVERSION_2019
Description: None
Column: INVERSION_2020
Description: None
Column: INVERSION_2021
Description: None
Column: INVERSION_2022
Description: None
Column: INVERSION_SEDE_FUERA
Description: None
Column: INVERSION_SIN_SEDE_FUERA
Description: None
Column: INVERSORES
Description: None
Column: INVERSORES_DASH
Description: None
Column: INVERSORES_EXTRANJEROS
Description: None
Column: INVERSORES_LOCALES
Description: None
Column: LEAD
Description: None
Column: LEAD_DASH
Description: None
Column: MES
Description: None
Column: MODIFICADO
Description: None
Column: NEXTUNICORN_ROUND
Description: None
Column: NOMBRE_DASH
Description: None
Column: NOMBRE_STARTUP
Description: None
Column: PAIS
Description: None
Column: Q
Description: None
Column: RANGOS_TAMANNO_RONDA
Description: None
Column: RECORD_ID
Description: None
Column: REFERENCIA
Description: None
Column: RONDAID_DASH
Description: None
Column: SCALEUP
Description: None
Column: SCREENSHOT
Description: None
Column: SECTOR_DASH
Description: None
Column: SECTOR_STARTUP
Description: None
Column: SEDE_FISCAL
Description: None
Column: SEDE_FISCAL_DASH
Description: None
Column: STA_WOMEN_LED
Description: None
Column: TAGS
Description: None
Column: TAGS_DASH
Description: None
Column: TAMANNO_RONDA
Description: None
Column: TIPOS_INVERSORES_DASH
Description: None
Column: TIPO_INVERSION
Description: None
Column: TIPO_INVERSORES
Description: None
Column: TOTAL_CAPTADO_STARTUP
Description: None
Column: TOTAL_RONDAS_STARTUP
Description: None
Column: UNICORN_ROUND
Description: None
Column: _INVERTIDOS_EXTRANJEROS
Description: None
Column: _INVERTIDOS_LOCALES
Description: None
Table: STARTUPS
Description: None
Columns:
Column: BIO
Description: None
Column: CAPTADO_2018
Description: None
Column: CAPTADO_2019
Description: None
Column: CAPTADO_2020
Description: None
Column: CAPTADO_2021
Description: None
Column: CAPTADO_2022
Description: None
Column: CIUDAD
Description: None
Column: CIUDAD_DASH
Description: None
Column: CUSTOMER_FOCUS
Description: None
Column: DESCRIPCION
Description: None
Column: EXITS
Description: None
Column: FECHA_CREADO
Description: None
Column: FECHA_MODIFICADO
Description: None
Column: INVERSORES
Description: None
Column: INVERSORES_DASH
Description: None
Column: NAME
Description: None
Column: NUM__RONDAS
Description: None
Column: PAIS
Description: None
Column: RECORD_ID
Description: None
Column: RONDAS
Description: None
Column: RONDAS_DASH
Description: None
Column: RONDAS_SEED
Description: None
Column: SCALEUPSPAIN
Description: None
Column: SECTOR
Description: None
Column: SECTOR_DASH
Description: None
Column: SEDE_FISCAL
Description: None
Column: SEDE_FISCAL_DASH
Description: None
Column: STA_WOMEN_LED
Description: None
Column: TAGS_STARTUP
Description: None
Column: TOTAL_INVERSION_CAPTADA
Description: None
Column: ULTIMA_RONDA
Description: None
Column: ULTIMA_RONDA_STAGE
Description: None
Column: UNICORN
Description: None
Column: UNICORN_CANDIDATE
Description: None
Table: TAGS
Description: None
Columns:
Column: COMMENT
Description: None
Column: RECORD_ID
Description: None
Column: SECTOR
Description: None
Column: SECTOR_DASH
Description: None
Column: STARTUPS
Description: None
Column: TAGNAME
Description: None
Column: TYPE
Description: None
